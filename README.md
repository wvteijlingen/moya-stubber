<img src="./swift-network-mocker.png" width="150" height="150"/>

# swift-network-mocker: network mocking for Swift

Swift Network Mocker speeds up development and testing by adding a network mockbing screen to your app.

Want to add a mock response? It's as easy as creating a new JSON file in your project repository.
Swift Network Mocker will automatically find it and make it activatable for mockbing.

Swift Network Mocker will:

- Provide an autogenerated view to activate and deactivate mocks at runtime.
- Allow you to configure multiple mocked responses per endpoint, so you can easilty test your code in multiple scenarios.
- Allow you to activate mocks programatically to simulate network responses in unit tests.
- Define a clear hierarchical structure for your mocks.

## Installation

**Swift Package Manager**

```swift
.package(url: "https://github.com/wvteijlingen/swift-network-mocker.git", .upToNextMajor(from: "0.2.0"))
```

**CocoaPods**

```ruby
pod "swift-network-mocker", :git => "https://github.com/wvteijlingen/swift-network-mocker.git"
```

## Usage

1. Create a bundle containing your JSON mock responses. See [Mock bundle file structure](#Mock-bundle-file-structure).
2. Configure your URLSession to use the mocker:

```swift
// Load the mocks bundle
let mocksBundle = Bundle(url: Bundle.main.bundleURL.appendingPathComponent("Mocks.bundle"))!
try! NetworkMocker.shared.setMocksBundle(mocksBundle)

// Configure the URLSessionConfiguration
let configuration = URLSessionConfiguration.default
configuration.protocolClasses = [MockingURLProtocol.self] + (configuration.protocolClasses ?? [])
```

3. Add the mocking view (using SwiftUI):

```swift
NavigationLink("Mocking", destination: NetworkMocker.EndpointsView())
```

## Mock bundle file structure

Swift Network Mocker expects the Mocks bundle to have the following structure:

1. Every endpoint that you want to mock must be a subdirectory of the `endpoints` directory.
1. Within each endpoint directory you can place multiple mocks with the following naming pattern `[method].[name].[statusCode].json`.
1. Mocks that you want to use for all endoints should be placed in the `generic` directory. This is useful if you want
to mock generic responses such as internal server errors.

### Example
```
Mocks.bundle
  | generic
      | any.serverError.500.json
      | any.notFound.404.json
  |
  | endpoints
      | users
      |   | get.ok.200.json
      |
      | users/{id}
      |   | get.ok.200.jpg
      |
      | users/0
      |   | get.notFound.404.json
```
